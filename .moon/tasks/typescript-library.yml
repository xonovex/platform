$schema: https://moonrepo.dev/schemas/tasks.json
implicitInputs:
- package.json
- tsconfig*.json
fileGroups:
  sources:
  - src/**/*
  tests:
  - src/**/*.test.*
  - src/**/*.spec.*
  - test/**/*
  configs:
  - '*.config.*'
  - .eslintrc*
  - .prettierrc*
tasks:
  build:
    deps:
    - ^:build
    command:
    - npm
    - run
    - build
    inputs:
    - '@globs(sources)'
    - tsconfig*.json
    outputs:
    - dist
    options:
      cache: true
  test:
    command:
    - npm
    - test
    deps:
    - ^:build
    inputs:
    - '@globs(sources)'
    - '@globs(tests)'
    - '@globs(configs)'
    outputs: []
    options:
      cache: true
  test-watch:
    command:
    - npm
    - run
    - test:watch
    deps:
    - ^:build
    options:
      cache: false
      runInCI: false
      persistent: true
    preset: server
  lint:
    command:
    - npm
    - run
    - lint
    deps:
    - ^:build
    inputs:
    - '@globs(sources)'
    - '@globs(tests)'
    - '@globs(configs)'
    outputs: []
  lint-fix:
    command:
    - npm
    - run
    - lint:fix
    inputs:
    - '@globs(sources)'
    - '@globs(tests)'
    - '@globs(configs)'
    outputs: []
    options:
      cache: false
  fmt:
    command:
    - npm
    - run
    - fmt
    inputs:
    - '@globs(sources)'
    - '@globs(tests)'
    - '@globs(configs)'
    - '*.json'
    - '*.md'
    outputs: []
    options:
      cache: false
  fmt-check:
    command:
    - npm
    - run
    - fmt:check
    inputs:
    - '@globs(sources)'
    - '@globs(tests)'
    - '@globs(configs)'
    - '*.json'
    - '*.md'
    outputs: []
  typecheck:
    command:
    - npm
    - run
    - typecheck
    deps:
    - ^:build
    inputs:
    - '@globs(sources)'
    - '@globs(tests)'
    - tsconfig*.json
    outputs: []
  ci-prepare:
    command: echo 'ci-prepare complete'
    deps:
    - build
    - test
    - lint
    - typecheck
    options:
      cache: false
  npm-publish:
    command:
    - npm
    - publish
    - --provenance
    - --access
    - public
    deps:
    - build
    options:
      cache: false
  npm-publish-dry-run:
    command:
    - npm
    - pack
    - --dry-run
    options:
      cache: false
  ci-publish:
    command: echo 'ci-publish complete'
    deps:
    - npm-publish
    options:
      cache: false
  ci-publish-dry-run:
    command: echo 'ci-publish-dry-run complete'
    deps:
    - npm-publish-dry-run
    options:
      cache: false
  coverage:
    command:
    - npm
    - run
    - coverage
    deps:
    - ^:build
    inputs:
    - '@globs(sources)'
    - '@globs(tests)'
    - '@globs(configs)'
    outputs:
    - coverage
    options:
      cache: true
inheritedBy:
  toolchain: typescript
  layer: library
